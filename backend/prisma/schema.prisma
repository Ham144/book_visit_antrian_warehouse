generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  username     String @id
  description  String
  isActive     Boolean  @default(true)
  displayName  String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  warehouseId  String?
  warehouse    Warehouse?    @relation(fields: [warehouseId], references: [id])
  subscription Subscription?
  organizations Organization[]
}

model Subscription {
  id            String @id
  user          User   @relation(fields: [userusername], references: [username])
  userusername  String @unique
  start DateTime
  plan SubscriptionPlan @default(TRIAL)
  organizationId String? @unique
  organizations Organization? @relation(fields: [organizationId], references: [subscriptionId]) 
} 

enum AuthMethod {
  LDAP
} 

model Warehouse {
  id String @id @default(uuid())
  name        String @unique
  location    String?
  description String?
  docks Dock[]
  members User[]
  isActive Boolean @default(true)
}

model Dock { //slot
  id    String   @id @default(cuid())
  name  String
  warehouseId String
  warehouse Warehouse @relation(fields: [warehouseId], references: [id])
  photos String[]
  availableFrom DateTime
  availableUntil DateTime
}

model Vehicle {
   id          String @id   @default(cuid())
   brand         String?
   jenisKendaraan String?
   durasiBongkar Int?
   description String?
   isActive Boolean @default(true)
}

model BusyTime {
  id String @id @default(cuid())
  title String
  recurring Recurring  
  startTime DateTime
  endTime DateTime
}

model Booking {
  id          String   @id @default(cuid())
  queue       Int
  date        DateTime
  day         String
  driverId   String
  startTime   DateTime
  endTime     DateTime
  koridorId String
  loadingTime Int
  plat       String
  slotId    String
  vehicleId  String
  warehouseId String
}

enum Recurring {
  DAILY
  WEEKLY
  MONTHLY
}


enum SubscriptionPlan {
  TRIAL
  PRO
  PREMIUM
}

model Organization {
  name String @id @unique
  members User[]
  subscriptionId String? @unique
  subscription Subscription?
  AD_HOST String?
  AD_PORT String?
  AD_DOMAIN String?
  AD_BASE_DN String?
}

model Globalsetting {//ini hanya satu di pakai di semua Organization
  settingName String @id @default(uuid())
  
  inUse Boolean @default(true)
  createdById String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}